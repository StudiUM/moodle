define ("core_calendar/calendar_view",["jquery","core/str","core/notification","core_calendar/selectors","core_calendar/events","core_calendar/view_manager","core_calendar/repository","core/modal_factory","core_calendar/modal_event_form","core/modal_events","core_calendar/crud"],function(a,b,c,d,e,f,g,h,i,j,k){var l=function(g,h){var i=a("body");k.registerRemove(g);var j="reloadCurrent"+h.charAt(0).toUpperCase()+h.slice(1);i.on(e.created,function(){f[j](g);g.find(d.groupSelector).val(0)});i.on(e.deleted,function(){f[j](g);g.find(d.groupSelector).val(0)});i.on(e.updated,function(){f[j](g);g.find(d.groupSelector).val(0)});g.on("change",d.courseSelector,function(){var b=a(this),e=b.val(),h=g.find(d.elements.courseSelector),i=g.find(d.elements.groupSelector),k=i.children().first();i.empty();i.append("<option value=\""+k.val()+"\">"+k.text()+"</option>");if(1<e){f.reloadGroupSelector(e).done(function(b){if(0===b.length){a("#coursegroupslabel").hide();i.hide();h.addClass("mr-auto")}else{a("#coursegroupslabel").show();i.show();h.removeClass("mr-auto");a.each(b,function(b,c){a("<option/>",{value:c.id,text:15<c.name.length?c.name.substring(0,14)+"...":c.name}).appendTo(i)})}})}else{i.hide();h.addClass("mr-auto")}f[j](g,e,null).then(function(){return g.find(d.courseSelector).val(e)}).then(function(){window.history.pushState({},"","?view=upcoming&course="+e)}).fail(c.exception)});g.on("change",d.elements.groupSelector,function(){var c=parseInt(a(this).val()),e=g.find(d.eventType.group),f=a("#nogroups"),h=0;if(0<f.length){f.remove()}if(0<e.length){a.each(e,function(b,d){var e=a(d);if(0===c||e.data("event-groupid")===c){e.show();h++}else{e.hide()}});if(0===h){var i=a(".eventlist"),j=a("<span id=\"nogroups\" class=\"calendar-information calendar-no-results\"></span>").appendTo(i);b.get_string("nogroupevents","core_calendar").done(function(a){j.text(a)})}}});i.on(e.filterChanged,function(a,b){var c=g.find(d.eventType[b.type]);if(!0==b.hidden){c.addClass("hidden")}else{c.removeClass("hidden")}});var l=k.registerEventFormModal(g);k.registerEditListeners(g,l)};return{init:function init(b,c){b=a(b);f.init(b,c);l(b,c)}}});
//# sourceMappingURL=calendar_view.min.js.map
